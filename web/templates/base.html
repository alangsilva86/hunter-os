<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or "Hunter OS" }}</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <span class="brand-mark">H</span>
        <div class="brand-copy">
          <div class="brand-title">Hunter OS</div>
          <div class="brand-sub">Mission control for B2B hunting</div>
        </div>
      </div>
      <nav class="nav">
        <a href="/mission">Mission</a>
        <a href="/vault">Vault</a>
        <a href="/person">Person</a>
        <a href="/exports">Exports</a>
        <a href="/recovery">Recovery</a>
        <a href="/diagnostics">Diagnostics</a>
        <a href="/config">Config</a>
      </nav>
    </header>
    <main class="main">
      {% block content %}{% endblock %}
    </main>
    <script>
      (function () {
        var toggle = document.querySelector("[data-auto-refresh]");
        if (toggle) {
          var key = "hunter:autoRefresh";
          var intervalMs = parseInt(toggle.getAttribute("data-auto-refresh-interval") || "20000", 10);
          var timer = null;
          toggle.checked = localStorage.getItem(key) === "1";
          var applyRefresh = function () {
            if (timer) {
              clearInterval(timer);
            }
            if (toggle.checked) {
              timer = setInterval(function () {
                window.location.reload();
              }, intervalMs);
            }
          };
          toggle.addEventListener("change", function () {
            localStorage.setItem(key, toggle.checked ? "1" : "0");
            applyRefresh();
          });
          applyRefresh();
        }

        document.addEventListener("click", function (event) {
          var button = event.target.closest("[data-fill-target],[data-fill-targets]");
          if (!button) {
            return;
          }
          var value = button.getAttribute("data-fill-value") || "";
          var targets = button.getAttribute("data-fill-targets");
          var selector = button.getAttribute("data-fill-target");
          var selectorList = [];
          if (targets) {
            selectorList = targets.split(",");
          } else if (selector) {
            selectorList = [selector];
          }
          selectorList.forEach(function (item) {
            var field = document.querySelector(item.trim());
            if (!field) {
              return;
            }
            field.value = value;
            field.focus();
          });
        });
      })();
    </script>
  </body>
</html>
